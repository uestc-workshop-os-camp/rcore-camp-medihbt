# Ch6 -- 文件系统

## 实现了什么 - ch6

1. 为 EasyFS 添加 Inode 引用计数机制, 现在文件系统支持硬链接
2. 实现了 `linkat()`, `unlinkat()` 和 `fstat()` 系统调用

## 实现了什么 - ch7

实现了一套邮箱机制.

## 反馈

1. sys_write() 每次写完都要刷新一遍磁盘缓冲区, 而我的 qemu-system-riscv64 + QEMU/KVM 两层嵌套虚拟机零散读写延迟巨大, 因此很经常超时.
   在 ch6 里, 30s 不够测完所有的项目, 经常要改 Makefile 到 60s 以上. 因此希望改一改 Makefile 的时间限制.

## 问答题 - ch6

1. 在我们的easy-fs中，root inode起着什么作用？如果root inode中的内容损坏了，会发生什么？

Root Inode 是根目录, 起索引下层文件的作用. 由于 easy-fs 仅仅支持一层目录, 因此 Root Inode 负责索引所有文件.

当 Root Inode 的内容损坏，那下面所有文件内容都会丢失，但已分配的数据块不会自动清除。因此整个文件系统发生损坏.

## 问答题 - ch7

1. 举出使用 pipe 的一个实际应用的例子。

Unix Shell 通过管道把 stdout 重定向到另一个进程的 stdin 里, 把两个文件流串联起来完成命令协作.

2. 如果需要在多个进程间互相通信，则需要为每一对进程建立一个管道，非常繁琐，请设计一个更易用的多进程通信机制。

邮箱机制: 发送者可以直接指定目标进程的 PID，把消息直接发送到目标 PID 的环形缓冲区里；接收者直接从自己的缓冲区读消息. 见 ch7:os/src/syscall 内的 sys_mailread sys_mailwrite 等系统调用.

## 荣誉准则

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 以下各位 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

> (无)

2. 此外，我也参考了 以下资料 ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

> (无)

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。